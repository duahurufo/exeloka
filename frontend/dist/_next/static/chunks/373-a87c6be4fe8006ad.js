"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[373],{4373:(e,t,s)=>{s.d(t,{A:()=>y});var a=s(95155),n=s(12115),r=s(68399),l=s(11949),i=s(43569),o=s(17349),c=s(36834),d=s(40707),m=s(92302),u=s(13948),h=s(88125),x=s(89731),p=s(35108),g=s(90960),j=s(22663);function y(e){let{isOpen:t,onClose:s,projectId:y,projectTitle:b,onAnalysisComplete:f}=e,[v,N]=(0,n.useState)(null),[w,k]=(0,n.useState)(!1),[A,_]=(0,n.useState)(""),[C,T]=(0,n.useState)(""),[F,S]=(0,n.useState)(""),[I,P]=(0,n.useState)(""),[E,R]=(0,n.useState)(""),{data:D,isLoading:L}=(0,p.useQuery)("prompt-templates",()=>g._x.getPromptTemplates(),{enabled:t&&w}),B=(0,p.useMutation)(e=>g._x.generateRecommendation(e),{onSuccess:e=>{j.Ay.success("Analysis completed successfully!"),f(e.data),s(),U()},onError:e=>{var t,s;j.Ay.error((null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Analysis failed")}});(0,n.useEffect)(()=>{D&&w&&(A||_(D.data.system_instruction),C||T(D.data.user_prompt))},[D,w]);let U=()=>{N(null),k(!1),_(""),T(""),S(""),P(""),R("")},q=e=>{N(e),"quick"===e&&k(!1)};return(0,a.jsx)(r.e,{appear:!0,show:t,as:n.Fragment,children:(0,a.jsxs)(l.l,{as:"div",className:"relative z-50",onClose:s,children:[(0,a.jsx)(r.e.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,a.jsx)(r.e.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(l.l.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)(l.l.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:['Choose Analysis Type for "',b,'"']}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",disabled:B.isLoading,children:(0,a.jsx)(i.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"border-2 rounded-lg p-6 cursor-pointer transition-colors ".concat("quick"===v?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>q("quick"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 text-green-600 mr-3"}),(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"Quick Analysis"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"~30 seconds"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"Free"})]})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Uses local neural network trained on Sampang cultural patterns. Provides immediate risk assessment and basic recommendations based on established cultural knowledge patterns."}),(0,a.jsx)("div",{className:"bg-green-50 p-3 rounded-md",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 text-green-600 mr-2 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-green-800",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"Best for:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,a.jsx)("li",{children:"Initial project assessment"}),(0,a.jsx)("li",{children:"Quick risk screening"}),(0,a.jsx)("li",{children:"Budget-conscious analysis"}),(0,a.jsx)("li",{children:"Time-sensitive decisions"})]})]})]})})]}),(0,a.jsxs)("div",{className:"border-2 rounded-lg p-6 cursor-pointer transition-colors ".concat("enhanced"===v?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>q("enhanced"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(u.A,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"Enhanced Analysis"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"~2-5 minutes"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"~$0.10-0.50"})]})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Uses advanced AI (OpenRouter) with comprehensive cultural knowledge base. Provides detailed analysis, nuanced recommendations, and comprehensive risk assessment with specific cultural context."}),(0,a.jsx)("div",{className:"bg-purple-50 p-3 rounded-md mb-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 text-purple-600 mr-2 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-purple-800",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"Best for:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,a.jsx)("li",{children:"Critical project decisions"}),(0,a.jsx)("li",{children:"Complex stakeholder situations"}),(0,a.jsx)("li",{children:"Detailed implementation planning"}),(0,a.jsx)("li",{children:"High-value projects"})]})]})]})}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 p-3 rounded-md",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("p",{className:"font-medium",children:"Cost & Time Notice:"}),(0,a.jsx)("p",{children:"This analysis uses AI services that incur costs and may take several minutes to complete."})]})]})})]})]}),v&&(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h4",{className:"text-md font-medium mb-4",children:"Additional Options (Optional)"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Additional Context"}),(0,a.jsx)("textarea",{className:"form-textarea h-20",placeholder:"Any specific information about your project, location, or concerns...",value:F,onChange:e=>S(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Priority Areas (comma-separated)"}),(0,a.jsx)("input",{type:"text",className:"form-input",placeholder:"e.g., religious sites, environmental impact, employment",value:I,onChange:e=>P(e.target.value)}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("label",{className:"form-label",children:"Specific Concerns (comma-separated)"}),(0,a.jsx)("input",{type:"text",className:"form-input",placeholder:"e.g., land disputes, water access, noise pollution",value:E,onChange:e=>R(e.target.value)})]})]})]}),"enhanced"===v&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>k(!w),className:"flex items-center text-blue-600 hover:text-blue-700 text-sm font-medium",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),w?"Hide":"Customize"," AI Instructions (Advanced)"]}),w&&(0,a.jsx)("div",{className:"mt-4 border rounded-lg p-4 bg-gray-50",children:L?(0,a.jsx)("div",{className:"text-center py-4",children:"Loading templates..."}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"System Instruction"}),(0,a.jsx)("textarea",{className:"form-textarea h-32 text-sm",value:A,onChange:e=>_(e.target.value),placeholder:"Define the AI's role and expertise..."}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null==D?void 0:D.data.recommended_usage.system_instruction})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"User Prompt Template"}),(0,a.jsx)("textarea",{className:"form-textarea h-32 text-sm",value:C,onChange:e=>T(e.target.value),placeholder:"Structure the analysis request..."}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null==D?void 0:D.data.recommended_usage.user_prompt})]})]})})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:s,disabled:B.isLoading,className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{type:"button",onClick:()=>{if(!v)return;let e={project_id:y,analysis_type:v};F.trim()&&(e.additional_context=F.trim()),I.trim()&&(e.priority_areas=I.split(",").map(e=>e.trim()).filter(e=>e)),E.trim()&&(e.specific_concerns=E.split(",").map(e=>e.trim()).filter(e=>e)),"enhanced"===v&&w&&(A.trim()&&A!==(null==D?void 0:D.data.system_instruction)&&(e.custom_system_instruction=A.trim()),C.trim()&&C!==(null==D?void 0:D.data.user_prompt)&&(e.custom_user_prompt=C.trim())),B.mutate(e)},disabled:!v||B.isLoading,className:"btn-primary flex items-center",children:B.isLoading?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Analyzing..."]}):(0,a.jsxs)(a.Fragment,{children:["Start ","quick"===v?"Quick":"Enhanced"," Analysis"]})})]})]})})})})]})})}},90960:(e,t,s)=>{s.d(t,{FH:()=>l,_x:()=>o,ao:()=>d,jd:()=>m,tK:()=>i,yj:()=>c});var a=s(95125),n=s(22663);class r{setupInterceptors(){this.client.interceptors.request.use(e=>(this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),e),e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var t,s,a;let r=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!r._retry){r._retry=!0;let e=localStorage.getItem("exeloka_refresh_token");if(e)try{let t=await this.client.post("/auth/refresh",{refreshToken:e});if(t.data.success){let{token:e,refreshToken:s}=t.data.data;return localStorage.setItem("exeloka_token",e),localStorage.setItem("exeloka_refresh_token",s),this.setAuthToken(e),r.headers.Authorization="Bearer ".concat(e),this.client(r)}}catch(e){this.handleAuthFailure()}else this.handleAuthFailure()}return(null==(a=e.response)||null==(s=a.data)?void 0:s.message)?401!==e.response.status&&n.Ay.error(e.response.data.message):"Network Error"===e.message?n.Ay.error("Network error. Please check your connection."):"ECONNABORTED"===e.code&&n.Ay.error("Request timeout. Please try again."),Promise.reject(e)})}handleAuthFailure(){localStorage.removeItem("exeloka_token"),localStorage.removeItem("exeloka_refresh_token"),this.setAuthToken(null),window.location.pathname.includes("/login")||window.location.pathname.includes("/register")||(window.location.href="/login")}setAuthToken(e){this.authToken=e}async get(e,t){return this.client.get(e,{params:t})}async post(e,t,s){return this.client.post(e,t,s)}async put(e,t){return this.client.put(e,t)}async delete(e){return this.client.delete(e)}async uploadFile(e,t,s){return this.client.post(e,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{s&&e.total&&s(Math.round(100*e.loaded/e.total))}})}async downloadFile(e,t){try{let s=await this.client.get(e,{responseType:"blob"}),a=new Blob([s.data]),r=window.URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=t||"download",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(r),n.Ay.success("File downloaded successfully")}catch(e){throw n.Ay.error("Failed to download file"),e}}constructor(){this.authToken=null,this.client=a.A.create({baseURL:"https://www.forrestofus.com/api",timeout:3e4,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}}let l=new r,i={ingestData:e=>l.post("/knowledge/ingest",e),addDirectEntry:e=>e instanceof FormData?l.uploadFile("/knowledge/direct",e):l.post("/knowledge/direct",e),search:(e,t)=>l.get("/knowledge/search",{query:e,...t}),getSources:e=>l.get("/knowledge/sources",e),getCategories:()=>l.get("/knowledge/categories"),getSource:e=>l.get("/knowledge/".concat(e)),deleteSource:e=>l.delete("/knowledge/sources/".concat(e))},o={create:e=>l.post("/recommendations/projects",e),getAll:e=>l.get("/recommendations/projects",e),getById:e=>l.get("/recommendations/projects/".concat(e)),update:(e,t)=>l.put("/recommendations/projects/".concat(e),t),delete:e=>l.delete("/recommendations/projects/".concat(e)),getPromptTemplates:()=>l.get("/recommendations/prompt-templates"),generateRecommendation:e=>l.post("/recommendations/generate",e),getRecommendations:e=>l.get("/recommendations",e),getRecommendation:e=>l.get("/recommendations/".concat(e)),submitFeedback:(e,t)=>l.post("/recommendations/".concat(e,"/feedback"),t),getAnalytics:()=>l.get("/recommendations/analytics"),getAnalyticsDashboard:e=>l.get("/recommendations/analytics/dashboard?range=".concat(e))},c={getAll:e=>l.get("/recommendations",e),getById:e=>l.get("/recommendations/".concat(e)),getByProject:e=>l.get("/recommendations?project=".concat(e)),submitFeedback:(e,t)=>l.post("/recommendations/".concat(e,"/feedback"),t),generateDocument:(e,t)=>l.post("/recommendations/".concat(e,"/generate-document"),{format:t},{responseType:"blob"}),delete:e=>l.delete("/recommendations/".concat(e))},d={generateDocx:e=>l.post("/documents/generate/docx",e),generateXlsx:e=>l.post("/documents/generate/xlsx",e),generatePptx:e=>l.post("/documents/generate/pptx",e),getDocuments:e=>l.get("/documents",e),downloadDocument:e=>l.downloadFile("/documents/download/".concat(e),e),getStats:()=>l.get("/documents/stats")},m={getInsights:e=>l.get("/recommendations/learning/insights",e),getStats:()=>l.get("/recommendations/learning/stats"),getFeedbackSummary:e=>l.get("/recommendations/".concat(e,"/feedback-summary"))}}}]);